{% extends 'store/base.html' %} {% load static %} {% block title %}Inicio{%endblock title %} {% block content %}
{{ branches_json|json_script:"branches-data" }}
<div class="modal fade" id="branchSelectorModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="branchSelectorModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-xl"> {# Cambiado a modal-xl para pantallas grandes #}
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="branchSelectorModalLabel">¬°Bienvenido! Elige tu Sucursal</h5>
                </div>
                <div class="modal-body">
                    <p class="text-center">Para ver el stock y precios correctos, por favor selecciona tu sucursal:</p>
                    
                    {# USAMOS LA GRILLA RESPONSIVA #}
                    <div class="row g-3 justify-content-center">
                        {% for branch in branches %}
                        
                        {# Columna responsiva: 1 por fila en sm, 2 en md, 4 en lg #}
                        <div class="col-12 col-sm-6 col-md-6 col-lg-3"> 
                            
                            <div 
                                role="button" {# Hace que se comporte como bot√≥n para accesibilidad #}
                                class="branch-card p-3 h-100 text-center shadow-sm"
                                data-branch-id="{{ branch.id }}"
                            >
                                {# üñºÔ∏è SVG de Fondo (Ajustado con CSS) #}
                                <div class="branch-icon-bg">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="icon icon-tabler icons-tabler-filled icon-tabler-home"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12.707 2.293l9 9c.63 .63 .184 1.707 -.707 1.707h-1v6a3 3 0 0 1 -3 3h-1v-7a3 3 0 0 0 -2.824 -2.995l-.176 -.005h-2a3 3 0 0 0 -3 3v7h-1a3 3 0 0 1 -3 -3v-6h-1c-.89 0 -1.337 -1.077 -.707 -1.707l9 -9a1 1 0 0 1 1.414 0m.293 11.707a1 1 0 0 1 1 1v7h-4v-7a1 1 0 0 1 .883 -.993l.117 -.007z" /></svg>
                                </div>
                                
                                {# üìù Contenido de la Sucursal (Encima del SVG) #}
                                <div class="branch-content">
                                    <strong class="text-primary">{{ branch.name }}</strong><br>
                                    <small class="text-secondary">{{ branch.address }}</small> <br>
                                    <span class="text-muted">{{ branch.opening_hours }}</span> <br>
                                    <span class="text-muted">{{ branch.phone }}</span>
                                </div>
                                
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="modal-footer">
                    <small class="text-danger" id="branchError" style="display:none;">Por favor, selecciona una sucursal.</small>
                    {% csrf_token %} 
                </div>
            </div>
        </div>
    </div>


  <div class="hero-section">
    <div
      id="carouselExampleAutoplaying"
      class="carousel slide hero-carousel"
      data-bs-ride="carousel"
      data-bs-interval="3000"
    >
      <div class="carousel-inner w-100 h-100">
        {% comment %} Nota: Ajusta la ruta est√°tica si es necesario (ej:
        /media/productos/carrouselX.jpg) {% endcomment %} {# Item 1: Activo por
        defecto #}
        <div class="carousel-item active w-100 h-100">
          <img
            src="/media/productos/carrousel1.jpg"
            class="d-block w-100 hero-img-fixed"
            alt="Tortas de Dise√±o"
          />
          <div class="dark-overlay"></div>
        </div>

        {# Item 2 #}
        <div class="carousel-item w-100 h-100">
          <img
            src="/media/productos/carrousel2.jpg"
            class="d-block w-100 hero-img-fixed"
            alt="Desayunos Sorpresa"
          />
          <div class="dark-overlay"></div>
        </div>

        {# Item 3 #}
        <div class="carousel-item w-100 h-100">
          <img
            src="/media/productos/carrousel3.jpg"
            class="d-block w-100 hero-img-fixed"
            alt="Mesa Dulce Artesanal"
          />
          <div class="dark-overlay"></div>
        </div>

        {# Item 4 #}
        <div class="carousel-item w-100 h-100">
          <img
            src="/media/productos/carrousel4.jpg"
            class="d-block w-100 hero-img-fixed"
            alt="Promociones de la Semana"
          />
          <div class="dark-overlay"></div>
        </div>
      </div>
    </div>
    <div class="container hero-content">
      <div class="starter-template text-center py-5">
        <h2 class="mt-5 display-4 text-warning text-shadow-lg">
          ¬°Bienvenidos a Quiero Algo Dulce!
        </h2>
        <p class="lead text-light text-shadow-lg">
          Tu tienda online de reposter√≠a artesanal.
        </p>
        <hr class="w-50 mx-auto border-warning" />

        <div class="text-white small mt-4 p-3 border rounded hero-info-box">
          <h3 class="mb-2 text-warning">Detalles del Proyecto</h3>
          <p class="mb-1">
            <em>Este es un sitio e-commerce construido con Django / Python.</em>
          </p>
          <hr class="my-2 border-secondary" />
          <p class="mb-0">Grupo: N¬∞ <strong class="text-light"> </strong></p>
          <p class="mb-0">
            Universidad Nacional de Jujuy Facultad de Ingenieria
          </p>
        </div>
      </div>
    </div>
  </div>
  
<main role="main" class="container mt-3">
  <!-- Secci√≥n de Categor√≠as -->
  <h3 class="text-center mt-5 mb-4 text-warning">
    Explora Nuestras Categor√≠as
  </h3>
  <div class="row g-4 justify-content-center pb-5">
    
    {# TARJETA 1: Tortas Cl√°sicas #}
    <div class="col-12 col-sm-6 col-md-4 col-lg-3 d-flex align-items-stretch">
      <a href="#" class="text-decoration-none w-100">
        <div class="flip-card shadow-lg h-100">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <img src="/media/productos/tortas_clasicas.jpg" alt="Tortas Cl√°sicas" class="card-img-top flip-card-img"/>
              <div class="overlay-text">
                <p class="title">Tortas Cl√°sicas</p>
              </div>
            </div>
            <div class="flip-card-back">
              <div class="back-content">
                <p class="title">Tortas Cl√°sicas</p>
                <p class="slogan">Sabores que evocan recuerdos. ¬°Elige tu favorita!</p>
                <span class="btn btn-sm btn-light mt-2 border border-warning">Ver Productos</span>
              </div>
            </div>
          </div>
        </div>
      </a>
    </div>

    {# TARJETA 2: Postres Fr√≠os  Cheesecakes #}
    <div class="col-12 col-sm-6 col-md-4 col-lg-3 d-flex align-items-stretch">
      <a href="#" class="text-decoration-none w-100">
        <div class="flip-card shadow-lg h-100">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <img src="/media/productos/postres_frios.jpg" alt="Postres Fr√≠os" class="card-img-top flip-card-img"/>
              <div class="overlay-text">
                <p class="title">Postres Fr√≠os Cheesecakes</p>
              </div>
            </div>
            <div class="flip-card-back">
              <div class="back-content">
                <p class="title">Postres Fr√≠os Cheesecakes</p>
                <p class="slogan">La frescura y cremosidad en cada bocado.</p>
                <span class="btn btn-sm btn-light mt-2 border border-warning">Ver Productos</span>
              </div>
            </div>
          </div>
        </div>
      </a>
    </div>

    {# TARJETA 3: Tartas y Pies #}
    <div class="col-12 col-sm-6 col-md-4 col-lg-3 d-flex align-items-stretch">
      <a href="#" class="text-decoration-none w-100">
        <div class="flip-card shadow-lg h-100">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <img src="media/productos/tartas_pies.jpg" alt="Tartas y Pays" class="card-img-top flip-card-img"/>
              <div class="overlay-text">
                <p class="title">Tartas y Pays</p>
              </div>
            </div>
            <div class="flip-card-back">
              <div class="back-content">
                <p class="title">Tartas y Pays</p>
                <p class="slogan">Texturas crujientes y rellenos inolvidables.</p>
                <span class="btn btn-sm btn-light mt-2 border border-warning">Ver Productos</span>
              </div>
            </div>
          </div>
        </div>
      </a>
    </div>

    {# TARJETA 4: Tortas de Celebraci√≥n #}
    <div class="col-12 col-sm-6 col-md-4 col-lg-3 d-flex align-items-stretch">
      <a href="#" class="text-decoration-none w-100">
        <div class="flip-card shadow-lg h-100">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <img src="media/productos/tortas_celebracion.jpg" alt="Tortas de Celebraci√≥n" class="card-img-top flip-card-img"/>
              <div class="overlay-text">
                <p class="title">Tortas de Celebraci√≥n</p>
              </div>
            </div>
            <div class="flip-card-back">
              <div class="back-content">
                <p class="title">Tortas de Celebraci√≥n</p>
                <p class="slogan">El centro de tu fiesta. Dise√±os a medida.</p>
                <span class="btn btn-sm btn-light mt-2 border border-warning">Ver Productos</span>
              </div>
            </div>
          </div>
        </div>
      </a>
    </div>


<!-- Secci√≥n Mapa Interactivo -->
<div class="container mt-5 mb-5">
    <h3 class="text-center mb-4 text-warning">Encuentra Tu Sucursal M√°s Cercana</h3>
    <p class="text-center text-muted mb-4">Haz clic en cualquier sucursal para establecerla como tu ubicaci√≥n preferida</p>
    
    <div class="row g-4">
        <!-- Lista de Sucursales -->
        <div class="col-lg-4">
            <div id="branch-list-container" class="shadow-sm">
                {% for branch in branches %}           
                    <div class="branch-item" 
                        data-id="{{ branch.id }}" 
                        data-lat="{{ branch.latitude }}" 
                        data-lon="{{ branch.longitude }}">
                        
                        <h5 class="card-title mb-1">{{ branch.name }}</h5>
                        <p class="card-text text-muted mb-1 small">
                            <i class="fas fa-map-marker-alt"></i> {{ branch.address }}
                        </p>
                        <p class="card-text text-muted mb-0 small">
                            <i class="fas fa-clock"></i> {{ branch.opening_hours }}
                        </p>
                        <span class="filter-status badge bg-success mt-1" data-id="{{ branch.id }}" style="display:none;">
                            <i class="fas fa-check"></i> Seleccionada
                        </span>
                    </div>
                {% empty %}
                    <p class="p-3 text-center text-muted">No hay sucursales registradas.</p>
                {% endfor %}
            </div>
        </div>

        <!-- Mapa -->
        <div class="col-lg-8">
            <div id="map-container-index" class="shadow-lg rounded">
                <!-- Mapa se carga aqu√≠ -->
            </div>
        </div>
    </div>
</div>

  <!-- Secci√≥n Acerca del Proyecto -->
  <div class="container mt-3 mb-5">
    <h3 class="text-center mt-2 mb-4 text-warning">
    Acerca de "Quiero Algo Dulce"
    </h3>
    <section id="historia-proyecto" class="card shadow" style="background-color: #F5F1E5;">
        
        <div class="card-body p-5 position-relative">
            <h3 class="card-title mb-4">¬øC√≥mo naci√≥ "Quiero Algo Dulce"?</h3>
            
            <p class="card-text text-justify lead">El concepto surge de la <strong> experiencia directa con la industria de la reposter√≠a artesanal </strong>. Uno de los miembros del equipo, con un <strong> s√≥lido historial como micro-emprendedor en el sector</strong>, identific√≥ una <strong>brecha clave en el mercado</strong>: la dificultad para los artesanos para lograr una visibilidad efectiva y conectar eficientemente con su clientela potencial.</p>

            <p class="card-text text-justify lead">Por esta raz√≥n, desarrollamos este <strong>e-commerce</strong>. Lo visualizamos como una <strong>soluci√≥n tecnol√≥gica esencial</strong> que busca empoderar a todos aquellos que desean emprender en este rubro desde sus hogares, facilitando la <strong>gesti√≥n de pedidos, la promoci√≥n y la conexi√≥n con el cliente final</strong>.</p>

            <p class="card-text text-justify lead"><strong>"Quiero Algo Dulce"</strong> es el resultado de la fusi√≥n de <strong>pasi√≥n por la reposter√≠a artesanal</strong> y un creciente inter√©s y <strong>dominio en la programaci√≥n y el desarrollo web</strong>. Este proyecto es nuestra apuesta actual de desarrollo que planeamos llevar a producci√≥n, convencidos de su valor y necesidad en el mercado.</p>
            
            <div class="position-absolute bottom-0 end-0 m-3">
                <img src="/media/productos/logoTREE.png" alt="Logo de Quiero Algo Dulce" class="img-fluid" style="width: 60px; height: auto; opacity: 0.7;">
            </div>
        </div>
    </section>
</div>
</main>

{% endblock content %} 

{% block extra_js %}
<script>
    // Funci√≥n para obtener el CSRF token (se mantiene por si acaso)
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.startsWith(name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    const csrftoken = getCookie('csrftoken');

    document.addEventListener('DOMContentLoaded', function() {
        
        // C√≥digo del modal
        var showModalStr = "{{ show_branch_modal|lower }}";
        var showModal = showModalStr === 'true';
        var modalElement = document.getElementById('branchSelectorModal');
        
        if (modalElement && showModal) {
            var modal = new bootstrap.Modal(modalElement, {
                backdrop: 'static',
                keyboard: false
            });
            modal.show();
        }

        // Inicializar el mapa solo para visualizaci√≥n
        loadLeafletAndInitializeMap();
        
        var csrfToken = document.querySelector('input[name="csrfmiddlewaretoken"]').value;
        var errorElement = document.getElementById('branchError');
        var footer = modalElement ? modalElement.querySelector('.modal-footer') : null;
        
        // Funci√≥n para mostrar el spinner de carga 
        function showLoading(show) {
            if (footer) {
                if (show) {
                    footer.innerHTML = `
                        <div class="d-flex align-items-center">
                            <span class="text-info me-2">Estableciendo sucursal...</span>
                            <div class="spinner-border spinner-border-sm text-info" role="status">
                                <span class="visually-hidden">Cargando...</span>
                            </div>
                        </div>
                    `;
                } else {
                    footer.innerHTML = `
                        <small class="text-danger" id="branchError" style="display:none;">Por favor, selecciona una sucursal.</small>
                        <input type="hidden" name="csrfmiddlewaretoken" value="${csrfToken}">
                    `;
                }
            }
        }

        // Conectar el evento CLICK a todas las tarjetas de sucursal (MODAL) 
        document.querySelectorAll('.branch-card').forEach(card => { 
            card.addEventListener('click', function() {
                
                document.querySelectorAll('.branch-card').forEach(btn => btn.classList.add('disabled-selection'));
                showLoading(true);

                var branchId = this.getAttribute('data-branch-id');
                
                errorElement.style.display = 'none';

                fetch("{% url 'set-branch' %}", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'X-CSRFToken': csrfToken
                    },
                    body: `branch_id=${branchId}`
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        var modalInstance = bootstrap.Modal.getInstance(modalElement);
                        modalInstance.hide();
                        window.location.reload();
                    } else {
                        throw new Error(data.error || 'Error al establecer la sucursal');
                    }
                })
                .catch(error => {
                    showLoading(false);             
                    errorElement.textContent = 'Error: ' + error.message;
                    errorElement.style.display = 'block';
                    document.querySelectorAll('.branch-card').forEach(btn => btn.classList.remove('disabled-selection'));
                });
            });
        });
    });

    function loadLeafletAndInitializeMap() {
        
        // Verificar datos primero
        const branchesDataElement = document.getElementById('branches-data');
        if (!branchesDataElement) {
            console.error('Elemento branches-data no encontrado');
            return;
        }

        let branches = [];
        try {
            const branchesJson = branchesDataElement.textContent;
            
            if (branchesJson && branchesJson.trim() !== '') {
                const parsedJson = JSON.parse(branchesJson);
                
                if (typeof parsedJson === 'string') {
                    branches = JSON.parse(parsedJson);
                } else {
                    branches = parsedJson;
                }
            }
        } catch (e) {
            console.error("Error al parsear JSON:", e);
            return;
        }

        if (!branches || !Array.isArray(branches) || branches.length === 0) {
            return;
        }

        // Verificar que las branches tengan coordenadas v√°lidas
        const validBranches = branches.filter(branch => {
            return branch.latitude && branch.longitude;
        });

        if (validBranches.length === 0) {
            return;
        }

        // Cargar Leaflet si no est√° cargado
        if (typeof L !== 'undefined') {
            createVisualizationMap(validBranches);
            return;
        }

        
        // Cargar CSS
        const leafletCSS = document.createElement('link');
        leafletCSS.rel = 'stylesheet';
        leafletCSS.href = '{% static "store/leaflet/leaflet.css" %}';
        document.head.appendChild(leafletCSS);
        
        // Cargar JS
        const leafletJS = document.createElement('script');
        leafletJS.src = '{% static "store/leaflet/leaflet.js" %}';
        leafletJS.onload = function() {
            //console.log('Leaflet cargado correctamente');
            setTimeout(() => {
                createVisualizationMap(validBranches);
            }, 100);
        };
        leafletJS.onerror = function() {
            console.error('Error al cargar Leaflet');
        };
        document.head.appendChild(leafletJS);
    }

    function createVisualizationMap(branches) {
        
        const mapContainer = document.getElementById('map-container-index');
        if (!mapContainer) {
            console.error('Contenedor del mapa no encontrado');
            return;
        }

        try {
            // Crear el mapa
            const firstBranch = branches[0];
            const map = L.map('map-container-index').setView(
                [firstBranch.latitude, firstBranch.longitude], 
                13
            );

            // Capa del mapa
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 18
            }).addTo(map);

            // Agregar marcadores SIMPLES (sin botones de selecci√≥n)
            const latLngs = [];
            const markers = {}; // Para guardar referencia a los marcadores

            branches.forEach(branch => {
                const marker = L.marker([branch.latitude, branch.longitude]).addTo(map)
                    .bindPopup(`
                        <div class="text-center">
                            <h6 class="text-warning mb-1"><strong>${branch.name}</strong></h6>
                            <p class="mb-1 small text-dark">${branch.address}</p>
                            <p class="mb-0 small text-muted">
                                <i class="fas fa-clock me-1"></i>${branch.opening_hours || ''}
                            </p>
                        </div>
                    `);
                
                // Guardar referencia al marcador
                markers[branch.id] = marker;
                latLngs.push([branch.latitude, branch.longitude]);
            });

            // Ajustar vista para mostrar todos los marcadores
            if (latLngs.length > 0) {
                const bounds = L.latLngBounds(latLngs);
                map.fitBounds(bounds, { padding: [20, 20] });
            }

            // Mostrar en el mapa al hacer clic en lista
            const branchItems = document.querySelectorAll('.branch-item');
            branchItems.forEach(item => {
                item.addEventListener('click', function() {
                    const id = parseInt(this.dataset.id);
                    const lat = parseFloat(this.dataset.lat);
                    const lon = parseFloat(this.dataset.lon);
                    
                    // Solo animaci√≥n del mapa - SIN selecci√≥n/filtrado
                    map.flyTo([lat, lon], 15, {
                        duration: 1
                    });

                    // Abrir el popup del marcador correspondiente
                    setTimeout(() => {
                        if (markers[id]) {
                            markers[id].openPopup();
                        }
                    }, 800);
                    
                  
                });
            });


        } catch (error) {
            console.error('Error al crear el mapa:', error);
        }
    }
</script>
{% endblock extra_js %}
{% block extra_styles %}
<style>
    /* Contenedor Principal (Define el √°rea del "Hero") */
    .hero-section {
        position: relative;
        min-height: 650px; 
        width: 100%;
        margin-top: 0; 
        
        display: flex;
        align-items: center;         justify-content: center;
        background-color: #333;
    }

    /* Carrusel como Fondo */
    .hero-carousel {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1; 
    }

    /* Imagen fija dentro del carrusel */
    .hero-img-fixed {
        object-fit: cover;
        height: 100%;
        filter: brightness(0.85);
    }

    /* Superposici√≥n Oscura en Carousel (Refuerza el contraste) */
    .dark-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.2); 
        z-index: 2;
    }

    /* Contenido de Bienvenida (Posicionado encima) */
    .hero-content {
        position: relative;
        z-index: 10; /* Debe estar por encima del carrusel y el overlay */
        max-width: 900px;
        color: white; 
    }
    
    /* Mejorar legibilidad del texto */
    .text-shadow-lg {
        text-shadow: 2px 2px 6px rgba(0, 0, 0, 1);
    }
    
    /* Caja de informaci√≥n del proyecto */
    .hero-info-box {
        background-color: rgba(0, 0, 0, 0.4);
        backdrop-filter: blur(5px);
        border-color: rgba(255, 255, 255, 0.3) !important;
    }

    .branch-card {
        cursor: pointer;
        border: 2px solid #ddd;
        border-radius: 0.5rem;
        transition: all 0.2s ease-in-out;
        position: relative; /* Contenedor para el SVG absoluto */
        overflow: hidden;
        background-color: #fcfcfc;
    }
    
    /* Hover y estado activo/seleccionado */
    .branch-card:hover {
        border-color: #ffc107; /* Amarillo de advertencia/atenci√≥n */
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }
    
    /* Contenedor del SVG de Fondo */
    .branch-icon-bg {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%); /* Centra el SVG */
        width: 100%; /* Tama√±o grande */
        height: 100%;
        color: #e9ecef; /* Color muy claro (gris sutil) */
        opacity: 0.8; 
        z-index: 1; /* Fondo */
    }
    
    /* SVG: Asegura que el √≠cono est√© grande y bien centrado */
    .branch-icon-bg svg {
        width: 90%;
        height: 90%;
    }
    
    /* Contenido de texto: Debe ir encima del SVG */
    .branch-content {
        position: relative;
        z-index: 2; /* Sobre el SVG */
    }

    /* Estilo para cuando se est√° procesando la selecci√≥n */
    .branch-card.disabled-selection {
        opacity: 0.6; /* Aten√∫a visualmente la tarjeta */
        cursor: not-allowed; /* Muestra el cursor de "prohibido" */
        pointer-events: none; /* Crucial: Deshabilita el clic para evitar doble submit */
    }

    /* =================================================== */
    /* ESTILOS PARA LAS TARJETAS FLIP (Categor√≠as) */
    /* =================================================== */

    .flip-card {
      background-color: transparent;
      width: 100%;
      height: 350px; 
      perspective: 1000px; 
      font-family: sans-serif;
    }

    /* El elemento A debe ser un bloque de altura 100% */
    .row a {
        width: 100%;
        display: block; 
    }

    .title {
      font-size: 1.5em;
      font-weight: 900;
      text-align: center;
      margin: 0;
    }

    .slogan {
      font-size: 1em;
      font-weight: 400;
      padding: 0 15px;
    }

    .flip-card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      text-align: center;
      transition: transform 0.8s;
      transform-style: preserve-3d; 
    }

    .flip-card:hover .flip-card-inner {
      transform: rotateY(180deg);
    }

   .flip-card-front, .flip-card-back {
      box-shadow: 0 6px 12px rgba(0,0,0,0.25);
      position: absolute; 
      display: flex;
      flex-direction: column;
      justify-content: center;
      top: 0; 
      left: 0;
      width: 100%;
      height: 100%;
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden; 
      border: 1px solid #ffc107;
      border-radius: 0.5rem;
      overflow: hidden;
    }

    /* ------------------ FRENTE (IMAGEN) ------------------ */
    .flip-card-front {
      background-color: #f8f4f5; 
      position: relative;
    }

    .flip-card-img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        filter: brightness(0.8);    }

    /* Texto superpuesto en el frente */
    .overlay-text {
        position: absolute;
        bottom: 0;
        width: 100%;
        background-color: rgba(0, 0, 0, 0.5); /* Fondo semitransparente oscuro */
        color: white;
        padding: 10px 0;
    }

    /* ------------------ REVERSO (FRASE) ------------------ */
    .flip-card-back {
      background: #F5F1E5;  
      color: #ffc107;
      transform: rotateY(180deg);
    }

    .back-content {
        padding: 20px;
    }

    .flip-card-back .title {
        color: #ffc107;
        margin-bottom: 10px;
    }

    /* Asegura que el bot√≥n sea visible */
    .flip-card-back .btn-light {
        font-weight: bold;
        color: #ff9800;
    }

    /* Deshabilita el texto que aparece al seleccionar */
    .flip-card-back p:last-child {
        display: none; 
    }

    /* Puedes mantener este CSS en tu archivo styles.css */
    .text-justify {
        text-align: justify !important; /* Asegura que el texto est√© justificado */
    }

    /* Opcional: Asegura que el color de fondo espec√≠fico #F5F1E5 siempre se aplique */
    .card-body {
        background-color: inherit; 
    }
    /* Estilos para el mapa en index */
    #map-container-index {
        height: 500px;
        width: 100%;
        border-radius: 0.5rem;
        border: 2px solid #ffc107;
        z-index: 1;
    }

    #branch-list-container {
        height: 500px;
        overflow-y: auto;
        border: 1px solid #eee;
        border-radius: 0.5rem;
        padding: 0;
        background: white;
    }

    .branch-item {
        padding: 1rem 1.25rem;
        border-bottom: 1px solid #f0f0f0;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .branch-item:hover {
        background-color: #fff9e6;
        transform: translateX(5px);
    }

    .branch-item:last-child {
        border-bottom: none;
    }

    .branch-item h5 {
        margin-bottom: 0.25rem;
        color: var(--bs-warning, #ffc107);
    }

    .branch-item .fa-map-marker-alt {
        color: #dc3545;
    }

    .branch-item .fa-clock {
        color: #0d6efd;
    }


</style>
{% endblock extra_styles %}