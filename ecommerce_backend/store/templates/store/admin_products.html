<!DOCTYPE html>
{% load static %}
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Vista de Productos</title>
    <style>
      body {
        font-family: sans-serif;
        margin: 2em;
      }
      table {
        width: 100%;
        border-collapse: collapse;
      }
      th,
      td {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: left;
      }
      th {
        background-color: #f2f2f2;
      }
      /* Estilo para hacer que las descripciones largas se vean mejor */
      .description-cell {
        max-width: 300px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      /* CLASES PARA MENSAJES - FIJAS */
      .alert-error {
        color: #d8000c;
        background-color: #ffd2d2;
        border: 1px solid #d8000c;
        padding: 10px;
        margin-bottom: 15px;
        border-radius: 4px;
      }
      .alert-success {
        color: #4f8a10;
        background-color: #dff2bf;
        border: 1px solid #4f8a10;
        padding: 10px;
        margin-bottom: 15px;
        border-radius: 4px;
      }
      .create-button {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background-color: #007bff;
        color: white;
        padding: 10px 15px;
        text-decoration: none;
        border-radius: 4px;
        margin-bottom: 20px;
      }
      .create-button:hover {
        background-color: #0056b3;
      }
      .action-buttons {
        display: flex;
        gap: 5px;
      }
      .action-buttons a,
      .action-buttons button {
        background: none;
        border: none;
        cursor: pointer;
        padding: 0;
      }
    </style>
  </head>
  <body>
    {% load static %}
    <!-- <script src="{% static 'store/js/load_reset.js' %}"></script>-->
    <div class="container">
      <h1>Cat√°logo de Productos (Tortas) üéÇ</h1>
      {% if messages %} {% for message in messages %}
      <div
        class="{% if message.tags == 'error' %}alert-error{% else %}alert-success{% endif %}"
      >
        {{ message }}
      </div>
      {% endfor %} {% endif %}
      <div>
        <a href="{% url 'product-create' %}" class="create-button">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="icon icon-tabler icons-tabler-outline icon-tabler-plus"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M12 5l0 14" />
            <path d="M5 12l14 0" />
          </svg>
          Crear Producto
        </a>
      </div>
      <p>
        Esta tabla muestra los datos del cat√°logo cargado desde el servicio.
      </p>
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Producto (T√≠tulo)</th>
            <th>Descripci√≥n</th>
            <th>ID Categor√≠a</th>
            <th>Precio</th>
            <th>Stock</th>
          </tr>
        </thead>
        <tbody>
          {% for product in products %}
          <tr>
            <td>{{ product.id }}</td>
            <td>{{ product.title }}</td>
            <td class="description-cell">{{ product.description }}</td>
            <td>{{ product.category_id }}</td>
            <td>${{ product.price }}</td>
            <td>{{ product.stock }}</td>

            <td class="action-buttons">
              <a href="{% url 'product-edit' pk=product.id %}" title="Editar">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="icon icon-tabler icons-tabler-outline icon-tabler-edit"
                >
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path
                    d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1"
                  />
                  <path
                    d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z"
                  />
                  <path d="M16 5l3 3" />
                </svg>
              </a>

              <form
                method="POST"
                action="{% url 'product-delete-html' pk=product.id %}"
                style="display: inline"
              >
                {% csrf_token %}
               
                <button
                  type="submit"
                  title="Eliminar"
                  onclick="return confirm('¬øEst√°s seguro de eliminar {{ product.title }}?')"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="1.5"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="icon icon-tabler icons-tabler-outline icon-tabler-square-rounded-minus"
                  >
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M9 12h6" />
                    <path
                      d="M12 3c7.2 0 9 1.8 9 9s-1.8 9 -9 9s-9 -1.8 -9 -9s1.8 -9 9 -9z"
                    />
                  </svg>
                </button>
              </form>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="7" class="text-center">
              No hay productos registrados
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </body>
</html>
